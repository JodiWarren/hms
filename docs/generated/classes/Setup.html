<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="utf-8">
<title>HMS - The Hackspace Management System » \Setup</title>
<meta name="author" content="Mike van Riel">
<meta name="description" content="">
<link href="../css/template.css" rel="stylesheet" media="all">
<script src="../js/jquery-1.7.1.min.js" type="text/javascript"></script><script src="../js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script><script src="../js/jquery.mousewheel.min.js" type="text/javascript"></script><script src="../js/bootstrap.js" type="text/javascript"></script><script src="../js/template.js" type="text/javascript"></script><script src="../js/prettify/prettify.min.js" type="text/javascript"></script><link rel="shortcut icon" href="../img/favicon.ico">
<link rel="apple-touch-icon" href="../img/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/apple-touch-icon-114x114.png">
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner"><div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="../index.html">HMS - The Hackspace Management System</a><div class="nav-collapse"><ul class="nav">
<li class="dropdown">
<a href="#api" class="dropdown-toggle" data-toggle="dropdown">
                                    API Documentation <b class="caret"></b></a><ul class="dropdown-menu">
<li><a>Packages</a></li>
<li><a href="../packages/app.Console.Command.html"><i class="icon-folder-open"></i> app.Console.Command</a></li>
<li><a href="../packages/app.Controller.html"><i class="icon-folder-open"></i> app.Controller</a></li>
<li><a href="../packages/app.Controller.Component.html"><i class="icon-folder-open"></i> app.Controller.Component</a></li>
<li><a href="../packages/app.Controller.Component.Auth.html"><i class="icon-folder-open"></i> app.Controller.Component.Auth</a></li>
<li><a href="../packages/app.Lib.AutomationDriver.html"><i class="icon-folder-open"></i> app.Lib.AutomationDriver</a></li>
<li><a href="../packages/app.Lib.CsvReader.html"><i class="icon-folder-open"></i> app.Lib.CsvReader</a></li>
<li><a href="../packages/app.Lib.Error.Exception.html"><i class="icon-folder-open"></i> app.Lib.Error.Exception</a></li>
<li><a href="../packages/app.Lib.Krb.html"><i class="icon-folder-open"></i> app.Lib.Krb</a></li>
<li><a href="../packages/app.Lib.MailChimp.html"><i class="icon-folder-open"></i> app.Lib.MailChimp</a></li>
<li><a href="../packages/app.Model.html"><i class="icon-folder-open"></i> app.Model</a></li>
<li><a href="../packages/app.Model.Behavior.html"><i class="icon-folder-open"></i> app.Model.Behavior</a></li>
<li><a href="../packages/app.View.Helper.html"><i class="icon-folder-open"></i> app.View.Helper</a></li>
<li><a href="../packages/dev.Setup.html"><i class="icon-folder-open"></i> dev.Setup</a></li>
<li><a href="../packages/dev.Setup.Cmd.html"><i class="icon-folder-open"></i> dev.Setup.Cmd</a></li>
<li><a href="../packages/dev.Setup.Lib.html"><i class="icon-folder-open"></i> dev.Setup.Lib</a></li>
<li><a href="../packages/dev.Setup.Web.html"><i class="icon-folder-open"></i> dev.Setup.Web</a></li>
<li><a href="../packages/plugins.MemberVoice.Controller.html"><i class="icon-folder-open"></i> plugins.MemberVoice.Controller</a></li>
<li><a href="../packages/plugins.MemberVoice.Model.html"><i class="icon-folder-open"></i> plugins.MemberVoice.Model</a></li>
</ul>
</li>
<li class="dropdown" id="charts-menu">
<a href="#charts" class="dropdown-toggle" data-toggle="dropdown">
                                    Charts <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="../graph_class.html"><i class="icon-list-alt"></i> Class hierarchy diagram</a></li></ul>
</li>
<li class="dropdown" id="reports-menu">
<a href="#reports" class="dropdown-toggle" data-toggle="dropdown">
                                    Reports <b class="caret"></b></a><ul class="dropdown-menu">
<li><a href="../errors.html"><i class="icon-remove-sign"></i> Errors 
                <span class="label label-info">0</span></a></li>
<li><a href="../markers.html"><i class="icon-map-marker"></i> Markers 
                <ul></ul></a></li>
<li><a href="../deprecated.html"><i class="icon-stop"></i> Deprecated elements 
                <span class="label label-info">0</span></a></li>
</ul>
</li>
</ul></div>
</div></div>
<div class="go_to_top"><a href="#___" style="color: inherit">Back to top  <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
<noscript><div class="alert alert-warning">
                            Javascript is disabled; several features are only available
                            if Javascript is enabled.
                        </div></noscript>
<div class="row">
<div class="span4">
<div class="btn-toolbar">
<div class="btn-group visibility" data-toggle="buttons-checkbox">
<button class="btn public active" title="Show public elements">Public</button><button class="btn protected" title="Show protected elements">Protected</button><button class="btn private" title="Show private elements">Private</button><button class="btn inherited active" title="Show inherited elements">Inherited</button>
</div>
<div class="btn-group view pull-right" data-toggle="buttons-radio">
<button class="btn details" title="Show descriptions and method names"><i class="icon-list"></i></button><button class="btn simple" title="Show only method names"><i class="icon-align-justify"></i></button>
</div>
</div>
<ul class="side-nav nav nav-list">
<li class="nav-header">
<i title="Methods" class="icon-custom icon-method"></i> Methods
                    <ul>
<li class="method public "><a href="#method___construct" title="__construct() :: Constructor."><span class="description">Constructor.</span><pre>__construct()</pre></a></li>
<li class="method public "><a href="#method_run" title="run() :: Run all selected setup steps."><span class="description">Run all selected setup steps.</span><pre>run()</pre></a></li>
<li class="method public "><a href="#method_setCreateDatabase" title="setCreateDatabase() :: Set up the database options."><span class="description">Set up the database options.</span><pre>setCreateDatabase()</pre></a></li>
<li class="method public "><a href="#method_setSetupTempFolders" title="setSetupTempFolders() :: Set if we should create the temporary folders."><span class="description">Set if we should create the temporary folders.</span><pre>setSetupTempFolders()</pre></a></li>
<li class="method public "><a href="#method_setUseDevelopmentEnvironment" title="setUseDevelopmentEnvironment() :: Set if we should use development or production configs, __settings and databases."><span class="description">Set if we should use development or production configs, __settings and databases.</span><pre>setUseDevelopmentEnvironment()</pre></a></li>
<li class="method public "><a href="#method_setUseRealKrb" title="setUseRealKrb() :: Set if we should use the real KRB lib or not."><span class="description">Set if we should use the real KRB lib or not.</span><pre>setUseRealKrb()</pre></a></li>
<li class="method public "><a href="#method_setUserInfo" title="setUserInfo() :: Set up the user info."><span class="description">Set up the user info.</span><pre>setUserInfo()</pre></a></li>
</ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="method private "><a href="#method___compareVersions" title="__compareVersions() :: Get the difference between two versions."><span class="description">Get the difference between two versions.</span><pre>__compareVersions()</pre></a></li>
<li class="method private "><a href="#method___copyKrbLibFile" title="__copyKrbLibFile() :: Copy either the real or dummy KRB Auth lib file to the lib folder."><span class="description">Copy either the real or dummy KRB Auth lib file to the lib folder.</span><pre>__copyKrbLibFile()</pre></a></li>
<li class="method private "><a href="#method___copyLibFile" title="__copyLibFile() :: Copy a file from one location to another, creating the folder if needed."><span class="description">Copy a file from one location to another, creating the folder if needed.</span><pre>__copyLibFile()</pre></a></li>
<li class="method private "><a href="#method___copyMcapiLibFile" title="__copyMcapiLibFile() :: Copy either the production or development MCAPI file."><span class="description">Copy either the production or development MCAPI file.</span><pre>__copyMcapiLibFile()</pre></a></li>
<li class="method private "><a href="#method___createDatabases" title="__createDatabases() :: Create and/or populate the databases for HMS"><span class="description">Create and/or populate the databases for HMS</span><pre>__createDatabases()</pre></a></li>
<li class="method private "><a href="#method___deleteDir" title="__deleteDir() :: Given a path to a directory, delete the directory and all it's contents."><span class="description">Given a path to a directory, delete the directory and all it's contents.</span><pre>__deleteDir()</pre></a></li>
<li class="method private "><a href="#method___distribureMembers" title="__distribureMembers() :: Divide $membersRemaining by $divisor, return the result and adjust $membersRemaining."><span class="description">Divide $membersRemaining by $divisor, return the result and adjust $membersRemaining.</span><pre>__distribureMembers()</pre></a></li>
<li class="method private "><a href="#method___executeUpdate" title="__executeUpdate() :: Attempt to execute the contents of an update file."><span class="description">Attempt to execute the contents of an update file.</span><pre>__executeUpdate()</pre></a></li>
<li class="method private "><a href="#method___generateData" title="__generateData() :: Generate the data that will populate the database."><span class="description">Generate the data that will populate the database.</span><pre>__generateData()</pre></a></li>
<li class="method private "><a href="#method___getCodeVersion" title="__getCodeVersion() :: Read the current version from the code."><span class="description">Read the current version from the code.</span><pre>__getCodeVersion()</pre></a></li>
<li class="method private "><a href="#method___getDbConnection" title="__getDbConnection() :: Get a mysqli database connection."><span class="description">Get a mysqli database connection.</span><pre>__getDbConnection()</pre></a></li>
<li class="method private "><a href="#method___getSettings" title="__getSettings() :: Get the __settings to use, either default setting or those loaded in from a file."><span class="description">Get the __settings to use, either default setting or those loaded in from a file.</span><pre>__getSettings()</pre></a></li>
<li class="method private "><a href="#method___getSqlFilesContaining" title="__getSqlFilesContaining() :: Get an array of all sql files in the ./sql folder that are valid for the current configuration and contain a certain string."><span class="description">Get an array of all sql files in the ./sql folder that are valid for the current configuration and contain a certain string.</span><pre>__getSqlFilesContaining()</pre></a></li>
<li class="method private "><a href="#method___getTableNameFromSchemaFile" title="__getTableNameFromSchemaFile() :: Given the path to an sql file that creats a table, get the name of the table"><span class="description">Given the path to an sql file that creats a table, get the name of the table</span><pre>__getTableNameFromSchemaFile()</pre></a></li>
<li class="method private "><a href="#method___isOnCommandline" title="__isOnCommandline() :: Check to see if we're running on the command line"><span class="description">Check to see if we're running on the command line</span><pre>__isOnCommandline()</pre></a></li>
<li class="method private "><a href="#method___isValidVersion" title="__isValidVersion() :: Given an array of version information, check if it is valid."><span class="description">Given an array of version information, check if it is valid.</span><pre>__isValidVersion()</pre></a></li>
<li class="method private "><a href="#method___logMessage" title="__logMessage() :: Format and write a log message, prepends timestamp and appends a newline."><span class="description">Format and write a log message, prepends timestamp and appends a newline.</span><pre>__logMessage()</pre></a></li>
<li class="method private "><a href="#method___popLogIndent" title="__popLogIndent() :: Decrease the log indent level."><span class="description">Decrease the log indent level.</span><pre>__popLogIndent()</pre></a></li>
<li class="method private "><a href="#method___pushLogIndent" title="__pushLogIndent() :: Increase the log indent level."><span class="description">Increase the log indent level.</span><pre>__pushLogIndent()</pre></a></li>
<li class="method private "><a href="#method___readDbVersion" title="__readDbVersion() :: Attempt to read the database version from the database.version file"><span class="description">Attempt to read the database version from the database.version file</span><pre>__readDbVersion()</pre></a></li>
<li class="method private "><a href="#method___replaceFields" title="__replaceFields() :: Replace variables in a template using the options in fields."><span class="description">Replace variables in a template using the options in fields.</span><pre>__replaceFields()</pre></a></li>
<li class="method private "><a href="#method___runAllQueriesInFileList" title="__runAllQueriesInFileList() :: Given a list of files containing sql queries, run all the queries."><span class="description">Given a list of files containing sql queries, run all the queries.</span><pre>__runAllQueriesInFileList()</pre></a></li>
<li class="method private "><a href="#method___runDataQueries" title="__runDataQueries() :: Run all queries marked as 'data'."><span class="description">Run all queries marked as 'data'.</span><pre>__runDataQueries()</pre></a></li>
<li class="method private "><a href="#method___runDatabaseUpdate" title="__runDatabaseUpdate() :: Update the database to the current version."><span class="description">Update the database to the current version.</span><pre>__runDatabaseUpdate()</pre></a></li>
<li class="method private "><a href="#method___runQuery" title="__runQuery() :: Run a query on a database object, returning the result"><span class="description">Run a query on a database object, returning the result</span><pre>__runQuery()</pre></a></li>
<li class="method private "><a href="#method___runQueryFromFile" title="__runQueryFromFile() :: Run a query from a file."><span class="description">Run a query from a file.</span><pre>__runQueryFromFile()</pre></a></li>
<li class="method private "><a href="#method___runSchemaQueries" title="__runSchemaQueries() :: Run all queries marked as 'schema'."><span class="description">Run all queries marked as 'schema'.</span><pre>__runSchemaQueries()</pre></a></li>
<li class="method private "><a href="#method___setupConfigFiles" title="__setupConfigFiles() :: Create the config files for the current environment, delete any no-longer needed config files."><span class="description">Create the config files for the current environment, delete any no-longer needed config files.</span><pre>__setupConfigFiles()</pre></a></li>
<li class="method private "><a href="#method___setupDatabase" title="__setupDatabase() :: Set-up a database."><span class="description">Set-up a database.</span><pre>__setupDatabase()</pre></a></li>
<li class="method private "><a href="#method___setupTempFolders" title="__setupTempFolders() :: Create the temporary folders for HMS, will delete the old ones if they exist."><span class="description">Create the temporary folders for HMS, will delete the old ones if they exist.</span><pre>__setupTempFolders()</pre></a></li>
<li class="method private "><a href="#method___stringToVersion" title="__stringToVersion() :: Given a string representation of a version, return an array of version data."><span class="description">Given a string representation of a version, return an array of version data.</span><pre>__stringToVersion()</pre></a></li>
<li class="method private "><a href="#method___validateOptions" title="__validateOptions() :: Check if the options used are valid."><span class="description">Check if the options used are valid.</span><pre>__validateOptions()</pre></a></li>
<li class="method private "><a href="#method___versionToString" title="__versionToString() :: Given an array of version data, return a string representation of that version."><span class="description">Given an array of version data, return a string representation of that version.</span><pre>__versionToString()</pre></a></li>
<li class="method private "><a href="#method___writeDbVersion" title="__writeDbVersion() :: Write a version to the database version file."><span class="description">Write a version to the database version file.</span><pre>__writeDbVersion()</pre></a></li>
<li class="method private "><a href="#method___writeToFile" title="__writeToFile() :: Write $data to the file at $path, overwriting the file if it exists."><span class="description">Write $data to the file at $path, overwriting the file if it exists.</span><pre>__writeToFile()</pre></a></li>
</ul>
</li>
<li class="nav-header">
<i title="Properties" class="icon-custom icon-property"></i> Properties
                    <ul></ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="property private "><a href="#property___createDb" title="$__createDb() :: If true create the instrumentation and instrumentation_test databases and populate them with tables and data."><span class="description"></span><pre>$__createDb</pre></a></li>
<li class="property private "><a href="#property___email" title="$__email() :: Email address the admin user should be created with."><span class="description"></span><pre>$__email</pre></a></li>
<li class="property private "><a href="#property___environmentType" title="$__environmentType() :: Prefer files with this suffix."><span class="description"></span><pre>$__environmentType</pre></a></li>
<li class="property private "><a href="#property___firstname" title="$__firstname() :: Firstname the admin user should be created with."><span class="description"></span><pre>$__firstname</pre></a></li>
<li class="property private "><a href="#property___logIndent" title="$__logIndent() :: Current log indentation level."><span class="description"></span><pre>$__logIndent</pre></a></li>
<li class="property private "><a href="#property___settings" title="$__settings() :: Array of __settings data."><span class="description"></span><pre>$__settings</pre></a></li>
<li class="property private "><a href="#property___setupTempFolders" title="$__setupTempFolders() :: If true create the temporary folders CakePHP needs."><span class="description"></span><pre>$__setupTempFolders</pre></a></li>
<li class="property private "><a href="#property___surname" title="$__surname() :: Surname the admin user should be created with."><span class="description"></span><pre>$__surname</pre></a></li>
<li class="property private "><a href="#property___useRealKrb" title="$__useRealKrb() :: If true then use the real KRB Auth lib, otherwise use a dummy one."><span class="description"></span><pre>$__useRealKrb</pre></a></li>
<li class="property private "><a href="#property___username" title="$__username() :: Username the admin user should be created with."><span class="description"></span><pre>$__username</pre></a></li>
</ul>
</li>
</ul>
</div>
<div class="span8">
<a id="\Setup"></a><ul class="breadcrumb">
<li>
<a href="../index.html"><i title="Classes" class="icon-custom icon-class"></i></a><span class="divider">\</span>
</li>
<li class="active">
<span class="divider">\</span><a href="../classes/Setup.html">Setup</a>
</li>
</ul>
<div class="element class">
<p class="short_description">Setup is a class that is responsible for parsing options and then performing certain steps based on those options.</p>
<div class="details">
<div class="long_description"></div>
<h3>
<i title="Methods" class="icon-custom icon-method"></i> Methods</h3>
<a id="method___construct"></a><div class="element clickable method public method___construct" data-toggle="collapse" data-target=".method___construct .collapse" title="public">
<h2>Constructor.</h2>
<pre>__construct() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method_run"></a><div class="element clickable method public method_run" data-toggle="collapse" data-target=".method_run .collapse" title="public">
<h2>Run all selected setup steps.</h2>
<pre>run() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method_setCreateDatabase"></a><div class="element clickable method public method_setCreateDatabase" data-toggle="collapse" data-target=".method_setCreateDatabase .collapse" title="public">
<h2>Set up the database options.</h2>
<pre>setCreateDatabase(bool $__createDb) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$__createDb</h4>
<code>bool</code><p>If true then the database will be created..</p></div>
</div></div>
</div>
<a id="method_setSetupTempFolders"></a><div class="element clickable method public method_setSetupTempFolders" data-toggle="collapse" data-target=".method_setSetupTempFolders .collapse" title="public">
<h2>Set if we should create the temporary folders.</h2>
<pre>setSetupTempFolders(bool $setupTempFolders) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$setupTempFolders</h4>
<code>bool</code><p>If true then temporary folders will be created.</p></div>
</div></div>
</div>
<a id="method_setUseDevelopmentEnvironment"></a><div class="element clickable method public method_setUseDevelopmentEnvironment" data-toggle="collapse" data-target=".method_setUseDevelopmentEnvironment .collapse" title="public">
<h2>Set if we should use development or production configs, __settings and databases.</h2>
<pre>setUseDevelopmentEnvironment(bool $useDevelopmentEnv) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$useDevelopmentEnv</h4>
<code>bool</code><p>If true then use development configs, __settings and databases.</p></div>
</div></div>
</div>
<a id="method_setUseRealKrb"></a><div class="element clickable method public method_setUseRealKrb" data-toggle="collapse" data-target=".method_setUseRealKrb .collapse" title="public">
<h2>Set if we should use the real KRB lib or not.</h2>
<pre>setUseRealKrb(bool $useRealKrb) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$useRealKrb</h4>
<code>bool</code><p>If true then the real KRB code will be copied in to the lib folder, if false, a dummy file will be copied.</p></div>
</div></div>
</div>
<a id="method_setUserInfo"></a><div class="element clickable method public method_setUserInfo" data-toggle="collapse" data-target=".method_setUserInfo .collapse" title="public">
<h2>Set up the user info.</h2>
<pre>setUserInfo(string $firstname, string $surname, string $username, string $email) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$firstname</h4>
<code>string</code><p>First name of the user.</p></div>
<div class="subelement argument">
<h4>$surname</h4>
<code>string</code><p>Surname of the user.</p></div>
<div class="subelement argument">
<h4>$username</h4>
<code>string</code><p>Username of the user.</p></div>
<div class="subelement argument">
<h4>$email</h4>
<code>string</code><p>Users e-mail.</p></div>
</div></div>
</div>
<a id="method___compareVersions"></a><div class="element clickable method private method___compareVersions" data-toggle="collapse" data-target=".method___compareVersions .collapse" title="private">
<h2>Get the difference between two versions.</h2>
<pre>__compareVersions(mixed $versionA, mixed $versionB) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$versionA</h4>
<code>mixed</code><p>An array of version data, or a string that can be converted into an array.</p></div>
<div class="subelement argument">
<h4>$versionB</h4>
<code>mixed</code><p>An array of version data, or a string that can be converted into an array.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An integer representing the difference between the versions, or null on error.</div>
</div></div>
</div>
<a id="method___copyKrbLibFile"></a><div class="element clickable method private method___copyKrbLibFile" data-toggle="collapse" data-target=".method___copyKrbLibFile .collapse" title="private">
<h2>Copy either the real or dummy KRB Auth lib file to the lib folder.</h2>
<pre>__copyKrbLibFile() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___copyLibFile"></a><div class="element clickable method private method___copyLibFile" data-toggle="collapse" data-target=".method___copyLibFile .collapse" title="private">
<h2>Copy a file from one location to another, creating the folder if needed.</h2>
<pre>__copyLibFile(string $fromFile, string $toFile) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$fromFile</h4>
<code>string</code><p>The path to copy the file from.</p></div>
<div class="subelement argument">
<h4>$toFile</h4>
<code>string</code><p>The path to copy the file to.</p></div>
</div></div>
</div>
<a id="method___copyMcapiLibFile"></a><div class="element clickable method private method___copyMcapiLibFile" data-toggle="collapse" data-target=".method___copyMcapiLibFile .collapse" title="private">
<h2>Copy either the production or development MCAPI file.</h2>
<pre>__copyMcapiLibFile() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___createDatabases"></a><div class="element clickable method private method___createDatabases" data-toggle="collapse" data-target=".method___createDatabases .collapse" title="private">
<h2>Create and/or populate the databases for HMS</h2>
<pre>__createDatabases() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___deleteDir"></a><div class="element clickable method private method___deleteDir" data-toggle="collapse" data-target=".method___deleteDir .collapse" title="private">
<h2>Given a path to a directory, delete the directory and all it's contents.</h2>
<pre>__deleteDir(string $dirPath) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$dirPath</h4>
<code>string</code><p>The path to the directory to delete.</p></div>
<h3>Exceptions</h3>
<table class="table table-bordered"><tr>
<th><code><a href="InvalidArgumentException.html">\InvalidArgumentException</a></code></th>
<td>if $dirPath is not a directory.</td>
</tr></table>
</div></div>
</div>
<a id="method___distribureMembers"></a><div class="element clickable method private method___distribureMembers" data-toggle="collapse" data-target=".method___distribureMembers .collapse" title="private">
<h2>Divide $membersRemaining by $divisor, return the result and adjust $membersRemaining.</h2>
<pre>__distribureMembers(int $membersRemaining, int $divisor) : int</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$membersRemaining</h4>
<code>int</code><p>(in, out) The number of members left to distribute.</p></div>
<div class="subelement argument">
<h4>$divisor</h4>
<code>int</code><p>The portion of members that should be used.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>int</code>The number of members used.</div>
</div></div>
</div>
<a id="method___executeUpdate"></a><div class="element clickable method private method___executeUpdate" data-toggle="collapse" data-target=".method___executeUpdate .collapse" title="private">
<h2>Attempt to execute the contents of an update file.</h2>
<pre>__executeUpdate(string $path) : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$path</h4>
<code>string</code><p>The path to the update file.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if execution was successful, false otherwise.</div>
</div></div>
</div>
<a id="method___generateData"></a><div class="element clickable method private method___generateData" data-toggle="collapse" data-target=".method___generateData .collapse" title="private">
<h2>Generate the data that will populate the database.</h2>
<pre>__generateData() : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if data was generated and written correctly, false otherwise.</div>
</div></div>
</div>
<a id="method___getCodeVersion"></a><div class="element clickable method private method___getCodeVersion" data-toggle="collapse" data-target=".method___getCodeVersion .collapse" title="private">
<h2>Read the current version from the code.</h2>
<pre>__getCodeVersion() : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>Array of the code version number, or null on error.</div>
</div></div>
</div>
<a id="method___getDbConnection"></a><div class="element clickable method private method___getDbConnection" data-toggle="collapse" data-target=".method___getDbConnection .collapse" title="private">
<h2>Get a mysqli database connection.</h2>
<pre>__getDbConnection(string $connName, bool $select) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$connName</h4>
<code>string</code><p>The name of the connection to get (e.g. default/test)</p></div>
<div class="subelement argument">
<h4>$select</h4>
<code>bool</code><p>If true then the database will be selected.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>A mysql connection on success, or null on failure.</div>
</div></div>
</div>
<a id="method___getSettings"></a><div class="element clickable method private method___getSettings" data-toggle="collapse" data-target=".method___getSettings .collapse" title="private">
<h2>Get the __settings to use, either default setting or those loaded in from a file.</h2>
<pre>__getSettings() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___getSqlFilesContaining"></a><div class="element clickable method private method___getSqlFilesContaining" data-toggle="collapse" data-target=".method___getSqlFilesContaining .collapse" title="private">
<h2>Get an array of all sql files in the ./sql folder that are valid for the current configuration and contain a certain string.</h2>
<pre>__getSqlFilesContaining(string $subStr) : array</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$subStr</h4>
<code>string</code><p>Files returned must contain this string.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>array</code>A list of filenames for sql files that match the $subStr and environment criteria.</div>
</div></div>
</div>
<a id="method___getTableNameFromSchemaFile"></a><div class="element clickable method private method___getTableNameFromSchemaFile" data-toggle="collapse" data-target=".method___getTableNameFromSchemaFile .collapse" title="private">
<h2>Given the path to an sql file that creats a table, get the name of the table</h2>
<pre>__getTableNameFromSchemaFile(string $path) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$path</h4>
<code>string</code><p>The path to the file to read.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>The name of the table if read successfully, null otherwise.</div>
</div></div>
</div>
<a id="method___isOnCommandline"></a><div class="element clickable method private method___isOnCommandline" data-toggle="collapse" data-target=".method___isOnCommandline .collapse" title="private">
<h2>Check to see if we're running on the command line</h2>
<pre>__isOnCommandline() : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if we're running on the command line, false otherwise.</div>
</div></div>
</div>
<a id="method___isValidVersion"></a><div class="element clickable method private method___isValidVersion" data-toggle="collapse" data-target=".method___isValidVersion .collapse" title="private">
<h2>Given an array of version information, check if it is valid.</h2>
<pre>__isValidVersion(array $version) : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$version</h4>
<code>array</code><p>An array of version data.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if version is valid, false otherwise.</div>
</div></div>
</div>
<a id="method___logMessage"></a><div class="element clickable method private method___logMessage" data-toggle="collapse" data-target=".method___logMessage .collapse" title="private">
<h2>Format and write a log message, prepends timestamp and appends a newline.</h2>
<pre>__logMessage(string $message) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$message</h4>
<code>string</code><p>The message to write.</p></div>
</div></div>
</div>
<a id="method___popLogIndent"></a><div class="element clickable method private method___popLogIndent" data-toggle="collapse" data-target=".method___popLogIndent .collapse" title="private">
<h2>Decrease the log indent level.</h2>
<pre>__popLogIndent() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___pushLogIndent"></a><div class="element clickable method private method___pushLogIndent" data-toggle="collapse" data-target=".method___pushLogIndent .collapse" title="private">
<h2>Increase the log indent level.</h2>
<pre>__pushLogIndent() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___readDbVersion"></a><div class="element clickable method private method___readDbVersion" data-toggle="collapse" data-target=".method___readDbVersion .collapse" title="private">
<h2>Attempt to read the database version from the database.version file</h2>
<pre>__readDbVersion() : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>Array of version data if successful, null on error.</div>
</div></div>
</div>
<a id="method___replaceFields"></a><div class="element clickable method private method___replaceFields" data-toggle="collapse" data-target=".method___replaceFields .collapse" title="private">
<h2>Replace variables in a template using the options in fields.</h2>
<pre>__replaceFields(string $template, array $fields) : string</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$template</h4>
<code>string</code><p>The template to work with.</p></div>
<div class="subelement argument">
<h4>$fields</h4>
<code>array</code><p>Key-value pair of names and the values to substitute.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>string</code>The template with values replaced.</div>
</div></div>
</div>
<a id="method___runAllQueriesInFileList"></a><div class="element clickable method private method___runAllQueriesInFileList" data-toggle="collapse" data-target=".method___runAllQueriesInFileList .collapse" title="private">
<h2>Given a list of files containing sql queries, run all the queries.</h2>
<pre>__runAllQueriesInFileList(\mysqli $databaseObj, string $fileList) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$databaseObj</h4>
<code><a href="mysqli.html">\mysqli</a></code><p>A database object to run the queries on.</p></div>
<div class="subelement argument">
<h4>$fileList</h4>
<code>string</code><p>The list of files.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An array of results of the queries that succeded.</div>
</div></div>
</div>
<a id="method___runDataQueries"></a><div class="element clickable method private method___runDataQueries" data-toggle="collapse" data-target=".method___runDataQueries .collapse" title="private">
<h2>Run all queries marked as 'data'.</h2>
<pre>__runDataQueries(\mysqli $databaseObj) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$databaseObj</h4>
<code><a href="mysqli.html">\mysqli</a></code><p>A database object to run the queries on.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An array of results of the queries that succeded.</div>
</div></div>
</div>
<a id="method___runDatabaseUpdate"></a><div class="element clickable method private method___runDatabaseUpdate" data-toggle="collapse" data-target=".method___runDatabaseUpdate .collapse" title="private">
<h2>Update the database to the current version.</h2>
<pre>__runDatabaseUpdate() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___runQuery"></a><div class="element clickable method private method___runQuery" data-toggle="collapse" data-target=".method___runQuery .collapse" title="private">
<h2>Run a query on a database object, returning the result</h2>
<pre>__runQuery(\mysqli $databaseObj, string $query) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$databaseObj</h4>
<code><a href="mysqli.html">\mysqli</a></code><p>A database object to run the query on.</p></div>
<div class="subelement argument">
<h4>$query</h4>
<code>string</code><p>The query to run.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An array of results if query is successful, or null on error.</div>
</div></div>
</div>
<a id="method___runQueryFromFile"></a><div class="element clickable method private method___runQueryFromFile" data-toggle="collapse" data-target=".method___runQueryFromFile .collapse" title="private">
<h2>Run a query from a file.</h2>
<pre>__runQueryFromFile(\mysqli $databaseObj, string $filepath) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$databaseObj</h4>
<code><a href="mysqli.html">\mysqli</a></code><p>A database object to run the query on.</p></div>
<div class="subelement argument">
<h4>$filepath</h4>
<code>string</code><p>Path to the file containing the query to run.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An array of results if query is successful, or null on error.</div>
</div></div>
</div>
<a id="method___runSchemaQueries"></a><div class="element clickable method private method___runSchemaQueries" data-toggle="collapse" data-target=".method___runSchemaQueries .collapse" title="private">
<h2>Run all queries marked as 'schema'.</h2>
<pre>__runSchemaQueries(\mysqli $databaseObj) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$databaseObj</h4>
<code><a href="mysqli.html">\mysqli</a></code><p>A database object to run the queries on.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>mixed</code>An array of results of the queries that succeded.</div>
</div></div>
</div>
<a id="method___setupConfigFiles"></a><div class="element clickable method private method___setupConfigFiles" data-toggle="collapse" data-target=".method___setupConfigFiles .collapse" title="private">
<h2>Create the config files for the current environment, delete any no-longer needed config files.</h2>
<pre>__setupConfigFiles() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___setupDatabase"></a><div class="element clickable method private method___setupDatabase" data-toggle="collapse" data-target=".method___setupDatabase .collapse" title="private">
<h2>Set-up a database.</h2>
<pre>__setupDatabase(string $prefix, bool $populate) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$prefix</h4>
<code>string</code><p>The prefix of the database to create.</p></div>
<div class="subelement argument">
<h4>$populate</h4>
<code>bool</code><p>If true then run schema and data queries on the newly created database.</p></div>
</div></div>
</div>
<a id="method___setupTempFolders"></a><div class="element clickable method private method___setupTempFolders" data-toggle="collapse" data-target=".method___setupTempFolders .collapse" title="private">
<h2>Create the temporary folders for HMS, will delete the old ones if they exist.</h2>
<pre>__setupTempFolders() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method___stringToVersion"></a><div class="element clickable method private method___stringToVersion" data-toggle="collapse" data-target=".method___stringToVersion .collapse" title="private">
<h2>Given a string representation of a version, return an array of version data.</h2>
<pre>__stringToVersion(string $versionStr) : array</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$versionStr</h4>
<code>string</code><p>A string representing a version.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>array</code>An array of version data.</div>
</div></div>
</div>
<a id="method___validateOptions"></a><div class="element clickable method private method___validateOptions" data-toggle="collapse" data-target=".method___validateOptions .collapse" title="private">
<h2>Check if the options used are valid.</h2>
<pre>__validateOptions() : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if options are valid, false otherwise.</div>
</div></div>
</div>
<a id="method___versionToString"></a><div class="element clickable method private method___versionToString" data-toggle="collapse" data-target=".method___versionToString .collapse" title="private">
<h2>Given an array of version data, return a string representation of that version.</h2>
<pre>__versionToString(array $version) : string</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$version</h4>
<code>array</code><p>An array of version data.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>string</code>A string representing the version data.</div>
</div></div>
</div>
<a id="method___writeDbVersion"></a><div class="element clickable method private method___writeDbVersion" data-toggle="collapse" data-target=".method___writeDbVersion .collapse" title="private">
<h2>Write a version to the database version file.</h2>
<pre>__writeDbVersion(string $version) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$version</h4>
<code>string</code><p>The version to write.</p></div>
</div></div>
</div>
<a id="method___writeToFile"></a><div class="element clickable method private method___writeToFile" data-toggle="collapse" data-target=".method___writeToFile .collapse" title="private">
<h2>Write $data to the file at $path, overwriting the file if it exists.</h2>
<pre>__writeToFile(string $path, string $data) : bool</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$path</h4>
<code>string</code><p>The path to the file.</p></div>
<div class="subelement argument">
<h4>$data</h4>
<code>string</code><p>The data to write.</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>bool</code>True if data was written successfully, false otherwise.</div>
</div></div>
</div>
<h3>
<i title="Properties" class="icon-custom icon-property"></i> Properties</h3>
<a id="property___createDb"> </a><div class="element clickable property private property___createDb" data-toggle="collapse" data-target=".property___createDb .collapse" title="private">
<h2>If true create the instrumentation and instrumentation_test databases and populate them with tables and data.</h2>
<pre>$__createDb : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>false</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___email"> </a><div class="element clickable property private property___email" data-toggle="collapse" data-target=".property___email .collapse" title="private">
<h2>Email address the admin user should be created with.</h2>
<pre>$__email : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>''</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___environmentType"> </a><div class="element clickable property private property___environmentType" data-toggle="collapse" data-target=".property___environmentType .collapse" title="private">
<h2>Prefer files with this suffix.</h2>
<pre>$__environmentType : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>'production'</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___firstname"> </a><div class="element clickable property private property___firstname" data-toggle="collapse" data-target=".property___firstname .collapse" title="private">
<h2>Firstname the admin user should be created with.</h2>
<pre>$__firstname : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>''</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___logIndent"> </a><div class="element clickable property private property___logIndent" data-toggle="collapse" data-target=".property___logIndent .collapse" title="private">
<h2>Current log indentation level.</h2>
<pre>$__logIndent : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>0</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___settings"> </a><div class="element clickable property private property___settings" data-toggle="collapse" data-target=".property___settings .collapse" title="private">
<h2>Array of __settings data.</h2>
<pre>$__settings : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>array()</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___setupTempFolders"> </a><div class="element clickable property private property___setupTempFolders" data-toggle="collapse" data-target=".property___setupTempFolders .collapse" title="private">
<h2>If true create the temporary folders CakePHP needs.</h2>
<pre>$__setupTempFolders : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>false</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___surname"> </a><div class="element clickable property private property___surname" data-toggle="collapse" data-target=".property___surname .collapse" title="private">
<h2>Surname the admin user should be created with.</h2>
<pre>$__surname : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>''</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___useRealKrb"> </a><div class="element clickable property private property___useRealKrb" data-toggle="collapse" data-target=".property___useRealKrb .collapse" title="private">
<h2>If true then use the real KRB Auth lib, otherwise use a dummy one.</h2>
<pre>$__useRealKrb : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>false</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property___username"> </a><div class="element clickable property private property___username" data-toggle="collapse" data-target=".property___username .collapse" title="private">
<h2>Username the admin user should be created with.</h2>
<pre>$__username : string</pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>''</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="row"><footer class="span12">
            Template is built using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap 2</a> and icons provided by <a href="http://glyphicons.com/">Glyphicons</a>.<br>
            Documentation is powered by <a href="http://www.phpdoc.org/">phpDocumentor 2.2.0
</a> and<br>
            generated on 2013-12-14T13:33:58Z.<br></footer></div>
</div>
</body>
</html>
